import{C as I,y as o,g as b,_ as j,l as F,c as m,b as n,F as w,i as T,t as u,p as k,d as x,n as O,q as V,x as A,o as v}from"./index-BWMkSv2y.js";import{a as h}from"./index-DW_MHI2K.js";const E=I("plantsStore",()=>{const c=o(),l=o(),p=o(),P=o(),y=o(!1),i=o(),_=o(),a=o(""),z=o(!1),C=o(),q=o(),L=o(1),S=o(0),G=b(()=>p.value&&a.value?p.value.filter(t=>t.species.name.toLowerCase().includes(a.value.toLowerCase())):p.value&&a.value===""?p.value:[]),B=b(()=>l.value&&a.value?l.value.filter(t=>t.name.toLowerCase().includes(a.value.toLowerCase())):l.value&&a.value===""?l.value:[]),D=b(()=>{if(!i.value||!l.value)return"";const e=l.value.find(t=>t.id===i.value);return e?e.name:""}),M=b(()=>{if(!_.value||!c.value)return"";const e=c.value.find(t=>t.id===_.value);return e?e.name:""}),N=()=>{y.value=!0;const t=new Promise(s=>{setTimeout(()=>{s()},600)});Promise.all([t,new Promise(s=>setTimeout(s,500))]).then(()=>{y.value=!1})};return{categories:c,getCategories:async()=>{try{const{data:e}=await h.get("/api/plantapp/category/");c.value=e.results.map(t=>({id:t.id,name:t.name}))}catch(e){console.error(e)}},genuses:l,getGenuses:async()=>{try{let e=[],t=1,s=!0;for(;s;){const{data:r}=await h.get(`/api/plantapp/genus/?page=${t}`),{results:g,next:$}=r;e=e.concat(g.map(f=>({id:f.id,category_id:f.category.id,name:f.name}))),$?t++:s=!1}const d=e.reduce((r,g)=>(r.some(f=>f.category_id===g.category_id&&f.name===g.name)||r.push(g),r),[]);l.value=d}catch(e){console.error(e)}},getPlants:async()=>{try{let e=[],t=new Set;const s={category_id:_.value||"",genus_id:i.value||"",pot_size:q.value||"",page:L.value||1,search:a.value||""},{data:d}=await h.get("/api/plantapp/plant/",{params:{genus__category:s.category_id,genus:s.genus_id,page:s.page,pot_size:s.pot_size,search:s.search}});for(const r of d.results){const g=`${r.species.name}-${r.min_price}-${r.min_height}-${r.min_pot_size}`;t.has(g)||(t.add(g),e.push(r))}S.value=d.totalPages,p.value=e}catch(e){console.error(e)}finally{N()}},plants:p,plant:P,getPlantById:async e=>{try{const{data:t}=await h.get(`/api/plantapp/plant/${e}/`);P.value=t}catch(t){console.error(t)}},isLoading:y,currentCategory:_,currentGenus:i,searchPlants:G,searchQuery:a,isTableMode:z,getPots:async()=>{try{const{data:e}=await h.get("/api/stockapp/pot-sizes/"),t=new Set(e.map(d=>d.pot_size)),s=Array.from(t).map(d=>({pot_size:d}));C.value=s}catch(e){console.error(e)}},pots:C,currentPot:q,searchGenuses:B,currentPage:L,totalPages:S,genusName:D,categoryName:M}}),Z="/static/sample-B-thTGo-.png",K=["onClick"],Q={__name:"Table",props:{head:{type:Object,required:!0},body:{type:Object,required:!0}},setup(c){const l=E(),p=V(),P=y=>{p.push({name:"plant-detail",params:{id:y}}),l.isTableMode=!1};return(y,i)=>{const _=A("auto-animate");return F((v(),m("table",{class:O(k(l).isTableMode?"table table--shadow":"table")},[n("thead",null,[n("tr",null,[(v(!0),m(w,null,T(c.head,a=>(v(),m("th",null,u(a),1))),256))])]),n("tbody",null,[k(l).isTableMode?(v(!0),m(w,{key:1},T(c.body,a=>(v(),m("tr",{onClick:z=>P(a.id)},[n("td",null,[n("span",null,u(a.species.genus.name),1),i[0]||(i[0]=x()),i[1]||(i[1]=n("br",null,null,-1)),x(" "+u(a.species.name),1)]),n("td",null,u(a.species.name_latin),1),n("td",null,"от "+u(a.min_pot_size),1),n("td",null," от "+u(a.min_height),1),n("td",null,"от "+u(a.min_price),1),n("td",null,u(a.species.description),1)],8,K))),256)):(v(!0),m(w,{key:0},T(c.body,a=>(v(),m("tr",null,[n("td",null,u(a.height),1),n("td",null,u(a.pot_size),1),n("td",null,u(a.price),1)]))),256))])],2)),[[_]])}}},ee=j(Q,[["__scopeId","data-v-78084c8d"]]);export{ee as T,Z as _,E as u};
